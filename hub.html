<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SYRIX // HUB</title>
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
</head>
<body class="dashboard-root" id="page-hub">

    <div id="hubLocked" class="auth-screen">
        <div class="card auth-box">
            <h2>SYRIX PROTOCOL</h2>
            <p id="auth-msg" style="margin-bottom:20px; color:#888;">RESTRICTED AREA</p>
            <button class="btn primary full-width" onclick="window.loginDiscord()">LOGIN WITH DISCORD</button>
            <button class="btn ghost full-width" onclick="window.location.href='index.html'" style="margin-top:10px;">EXIT</button>

            <div id="app-form" style="display:none; text-align:left; margin-top:20px; border-top:1px solid #333; padding-top:20px;">
                <h3 class="tag">ENLISTMENT</h3>
                <input id="app-ign" class="dash-input" placeholder="Riot ID (Name#TAG)">
                <input id="app-tracker" class="dash-input" placeholder="Tracker.gg Link">
                <select id="app-rank" class="dash-input"><option>Ascendant</option><option>Immortal</option><option>Radiant</option></select>
                <select id="app-role" class="dash-input"><option>Duelist</option><option>Initiator</option><option>Controller</option><option>Sentinel</option><option>Flex</option></select>
                <textarea id="app-why" class="dash-input" placeholder="Why join?" rows="2"></textarea>
                <button class="btn primary full-width" onclick="window.submitApp()">SUBMIT APPLICATION</button>
            </div>
        </div>
    </div>

    <div id="hubUnlocked" style="display:none; height:100%;">
        <header class="hub-header">
            <div class="header-top">
                <div class="logo">SYRIX <span style="color:var(--red)">HUB</span></div>
                <div style="display:flex; gap:15px; align-items:center;">
                    <div id="user-name" style="font-weight:bold;">OPERATOR</div>
                    <button class="btn ghost" style="padding:5px 10px; font-size:0.7rem;" onclick="firebase.auth().signOut()">LOGOUT</button>
                </div>
            </div>
            <div class="header-bottom">
                <nav class="scroll-nav">
                    <button class="nav-pill active" onclick="window.setTab('dashboard', this)">DASHBOARD</button>
                    <button class="nav-pill" onclick="window.setTab('matches', this)">MATCHES</button>
                    <button class="nav-pill" onclick="window.setTab('warroom', this)">WAR ROOM</button>
                    <button class="nav-pill" onclick="window.setTab('stratbook', this)">STRATBOOK</button>
                    <button class="nav-pill" onclick="window.setTab('lineups', this)">LINEUPS</button>
                    <button class="nav-pill" onclick="window.setTab('roster', this)">ROSTER MGR</button>
                    <button class="nav-pill" onclick="window.setTab('mapveto', this)">MAP VETO</button>
                    <button class="nav-pill admin-only" style="display:none; border-color:var(--red);" onclick="window.setTab('admin', this)">ADMIN</button>
                </nav>
            </div>
        </header>

        <main class="dash-content">

            <div id="dashboard" class="tabView active">
                <div class="dashboard-grid">
                    <div class="dash-col-left">
                        <div class="card">
                            <h3 class="tag">CAPTAIN'S MESSAGE <button onclick="window.editMsg()" style="float:right; background:none; border:none; color:#555; cursor:pointer;">Edit</button></h3>
                            <p id="capt-msg" style="font-style:italic; font-size:1.1rem;">Loading...</p>
                            <div id="capt-edit" style="display:none; margin-top:10px;">
                                <textarea id="capt-input" class="dash-input"></textarea>
                                <button class="btn primary full-width" onclick="window.saveMsg()">SAVE</button>
                            </div>
                        </div>
                        <div class="card">
                            <h3 class="tag">ABSENCE LOG</h3>
                            <div style="display:flex; gap:10px;">
                                <input type="date" id="abs-start" class="dash-input">
                                <input type="date" id="abs-end" class="dash-input">
                            </div>
                            <input id="abs-reason" class="dash-input" placeholder="Reason">
                            <button class="btn ghost full-width" onclick="window.logAbsence()">LOG ABSENCE</button>
                            <div id="abs-list" style="margin-top:15px; font-size:0.8rem; color:#888;"></div>
                        </div>
                    </div>

                    <div class="dash-col-right">
                        <div class="card" style="height:100%;">
                            <h3 class="tag">UPCOMING EVENTS</h3>
                            <div id="dash-events" style="display:flex; flex-direction:column; gap:10px;">Loading...</div>
                        </div>
                    </div>

                    <div class="dash-col-stats">
                        <div class="card">
                            <h3 class="tag">WIN RATE</h3>
                            <div id="stat-win" style="font-size:3rem; font-weight:900;">--%</div>
                        </div>
                        <div class="card">
                            <h3 class="tag">ACTIVE OPS</h3>
                            <div id="stat-ops" style="font-size:3rem; font-weight:900;">0</div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="stratbook" class="tabView">
                <div class="strat-container">
                    <div class="canvas-wrap">
                        <canvas id="vpCanvas"></canvas>
                        <img id="vpMapImg" src="">
                        <div style="position:absolute; top:10px; left:10px; z-index:20; background:#111; padding:5px; border-radius:4px; display:flex; gap:5px;">
                            <button onclick="window.tool='draw'" class="btn ghost" style="padding:5px 10px;">‚úèÔ∏è</button>
                            <button onclick="window.tool='agent'" class="btn ghost" style="padding:5px 10px;">üë§</button>
                            <input type="color" id="vpColor" value="#ff1e3c" style="height:30px; border:none;">
                            <button onclick="window.saveStrat()" class="btn primary" style="padding:5px 10px;">üíæ</button>
                            <button onclick="window.clearStrat()" class="btn ghost" style="padding:5px 10px; color:red;">üóë</button>
                        </div>
                    </div>
                    <div class="card">
                        <label class="tag">MAP SELECT</label>
                        <select id="vpMapSelect" class="dash-input" onchange="window.changeMap()">
                            <option value="ascent">ASCENT</option>
                            <option value="bind">BIND</option>
                            <option value="haven">HAVEN</option>
                            <option value="lotus">LOTUS</option>
                            <option value="split">SPLIT</option>
                            <option value="sunset">SUNSET</option>
                            <option value="abyss">ABYSS</option>
                        </select>
                        <label class="tag" style="margin-top:20px;">AGENTS</label>
                        <div id="agent-palette" style="display:grid; grid-template-columns:repeat(4,1fr); gap:5px;"></div>
                    </div>
                </div>
            </div>

            <div id="matches" class="tabView">
                <div class="split-view">
                    <div class="card">
                        <h3 class="tag">LOG MATCH / SCRIM</h3>
                        <input id="m-opp" class="dash-input" placeholder="Opponent">
                        <div style="display:flex; gap:10px;">
                            <input type="number" id="m-us" class="dash-input" placeholder="Us">
                            <input type="number" id="m-them" class="dash-input" placeholder="Them">
                        </div>
                        <input type="date" id="m-date" class="dash-input">
                        <select id="m-map" class="dash-input">
                            <option>Ascent</option>
                            <option>Bind</option>
                            <option>Haven</option>
                            <option>Lotus</option>
                            <option>Pearl</option>
                            <option>Split</option>
                            <option>Sunset</option>
                            <option>Abyss</option>
                        </select>
                        <button class="btn primary full-width" onclick="window.addMatch()">ADD RECORD</button>
                    </div>
                    <div class="card">
                        <h3 class="tag">HISTORY</h3>
                        <div id="match-list" style="overflow-y:auto; max-height:600px;"></div>
                    </div>
                </div>
            </div>

            <div id="warroom" class="tabView">
                <div class="split-view">
                    <div class="card">
                        <h3 class="tag">TARGETS</h3>
                        <button class="btn ghost full-width" onclick="window.newEnemy()">+ NEW TARGET</button>
                        <div id="enemy-list" style="margin-top:15px;"></div>
                    </div>
                    <div class="card">
                        <h3 class="tag" id="wr-title">SELECT TARGET</h3>
                        <div id="wr-content" style="display:none;">
                            <label class="tag">INTEL / NOTES</label>
                            <textarea id="wr-notes" class="dash-input" style="height:300px;"></textarea>
                            <button class="btn primary" onclick="window.saveIntel()">UPDATE INTEL</button>
                            <button class="btn ghost" onclick="window.deleteEnemy()" style="color:red; border-color:red;">DELETE</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="lineups" class="tabView">
                <div class="card">
                    <h3 class="tag">LINEUP LIBRARY</h3>
                    <div class="grid-gallery" id="lineup-grid">
                        <div class="gallery-card" onclick="window.addLineup()" style="display:flex; align-items:center; justify-content:center; border:2px dashed #333;">+ ADD NEW</div>
                    </div>
                </div>
            </div>

            <div id="roster" class="tabView">
                <div class="split-view">
                    <div class="card">
                        <h3 class="tag">MEMBERS</h3>
                        <div id="roster-list-edit"></div>
                    </div>
                    <div class="card">
                        <h3 class="tag">EDIT PROFILE</h3>
                        <div id="roster-edit-form" style="display:none;">
                            <input id="r-id" class="dash-input" disabled style="color:#555;">
                            <select id="r-role" class="dash-input"><option>Captain</option><option>Main</option><option>Sub</option><option>Coach</option></select>
                            <input id="r-pfp" class="dash-input" placeholder="Image URL">
                            <button class="btn primary full-width" onclick="window.saveRosterProfile()">SAVE CHANGES</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="mapveto" class="tabView">
                <div class="card">
                    <h3 class="tag">MAP VETO BOARD <button onclick="window.resetVeto()" style="float:right; font-size:0.7rem; background:none; border:none; color:white; cursor:pointer;">RESET</button></h3>
                    <div id="veto-grid" class="grid-gallery"></div>
                </div>
            </div>

            <div id="admin" class="tabView">
                <div class="card">
                    <h3 class="tag">PENDING APPLICATIONS</h3>
                    <div id="admin-list"></div>
                </div>
            </div>

        </main>
    </div>

    <script src="assets/js/script.js"></script>
</body>
</html>